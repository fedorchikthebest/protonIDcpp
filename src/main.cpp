#include"include/gost/kuznyechik.h"
#include"include/gost/cfb.h"
#include<iostream>
#include<string.h>

int main(){
    unsigned char key[] = {
        0xef, 0xcd, 0xab, 0x89, 0x67, 0x45, 0x23, 0x01,
        0x10, 0x32, 0x54, 0x76, 0x98, 0xba, 0xdc, 0xfe,
        0x77, 0x66, 0x55, 0x44, 0x33, 0x22, 0x11, 0x00,
        0xff, 0xee, 0xdd, 0xcc, 0xbb, 0xaa, 0x99, 0x88
    };

    unsigned char iv[] = {
        0x88, 0x99, 0xaa, 0xbb, 0xcc, 0xdd, 0xee, 0xff,
        0x00, 0x77, 0x66, 0x55, 0x44, 0x33, 0x22, 0x11,
    };

    unsigned char text[] = {
        0x88, 0x99, 0xaa, 0xbb, 0xcc, 0xdd, 0xee, 0xff,
        0x00, 0x77, 0x66, 0x55, 0x44, 0x33, 0x22, 0x11,
        0x88, 0x99, 0xaa, 0xbb, 0xcc, 0xdd, 0xee, 0xff,
        0x00, 0x77, 0x66, 0x55, 0x44, 0x33, 0x22, 0x11,
    };


    unsigned char out[32];

    for (int i = 0; i < 32; i++) std::cout << (int)text[i] << ' ';

    std::cout << std::endl;

    kuznechik_cfb(text, out, key, iv, 32);

    for (int i = 0; i < 32; i++) std::cout << (int)out[i] << ' ';

    std::cout << std::endl;

    memcpy(text, out, 32);

    kuznechik_cfb(text, out, key, iv, 32);

    for (int i = 0; i < 32; i++) std::cout << (int)out[i] << ' ';

    std::cout << std::endl;
}